--- pwlib/make/common.mak.orig	2003-02-03 07:08:52.000000000 +0100
+++ pwlib/make/common.mak	2003-07-12 23:41:53.000000000 +0200
@@ -339,6 +339,7 @@
 	$(LD)   --split-by-reloc 65535 -r   $(OBJS) -o $@ 
 endif
 
+ifdef PWLIB_BUILD
 ifdef DEBUG
 
 ifneq (,$(wildcard $(PWLIBDIR)/src/ptlib/unix))
@@ -364,6 +365,7 @@
 endif
 
 endif
+endif
 
 CLEAN_FILES += $(TARGET)
 
--- pwlib/make/gui.mak.orig	2001-06-15 02:58:00.000000000 +0200
+++ pwlib/make/gui.mak	2003-07-12 23:42:53.000000000 +0200
@@ -64,11 +64,11 @@
 #
 
 
-include $(PWLIBDIR)/make/defaultgui.mak
+include $(PWLIBMAKEDIR)/defaultgui.mak
 
 ifneq (,$(GUI_TYPE))
 
-include $(PWLIBDIR)/make/$(GUI_TYPE).mak
+include $(PWLIBMAKEDIR)/$(GUI_TYPE).mak
 
 ifndef	GUI_SRC_NAME
 GUI_SRC_NAME	= $(GUI_TYPE)
--- pwlib/make/ptlib.mak.orig	1998-12-02 03:37:31.000000000 +0100
+++ pwlib/make/ptlib.mak	2003-07-12 23:44:42.000000000 +0200
@@ -35,10 +35,13 @@
 #
 
 ifndef PWLIBDIR
-PWLIBDIR=$(HOME)/pwlib
+PWLIBDIR=/usr
+endif
+ifndef PWLIBMAKEDIR
+PWLIBMAKEDIR=/usr/share/pwlib/make
 endif
 
-include $(PWLIBDIR)/make/unix.mak
-include $(PWLIBDIR)/make/common.mak
+include $(PWLIBMAKEDIR)/unix.mak
+include $(PWLIBMAKEDIR)/common.mak
 
 # End of ptlib.mak
--- pwlib/make/pwlib.mak.orig	1998-12-02 03:39:53.000000000 +0100
+++ pwlib/make/pwlib.mak	2003-07-12 23:45:21.000000000 +0200
@@ -44,11 +44,14 @@
 #
 
 ifndef PWLIBDIR
-PWLIBDIR=$(HOME)/pwlib
+PWLIBDIR=/usr
+endif
+ifndef PWLIBMAKEDIR
+PWLIBMAKEDIR=/usr/share/pwlib/make
 endif
 
-include $(PWLIBDIR)/make/unix.mak
-include $(PWLIBDIR)/make/gui.mak
-include $(PWLIBDIR)/make/common.mak
+include $(PWLIBMAKEDIR)/unix.mak
+include $(PWLIBMAKEDIR)/gui.mak
+include $(PWLIBMAKEDIR)/common.mak
 
 # End of pwlib.mak
--- pwlib/make/unix.mak.orig	2003-05-22 14:17:06.000000000 +0200
+++ pwlib/make/unix.mak	2003-07-12 23:46:41.000000000 +0200
@@ -57,13 +57,16 @@
 #
 
 ifndef PWLIBDIR
-PWLIBDIR = $(HOME)/pwlib
+PWLIBDIR=@prefix@
+endif
+ifndef PWLIBMAKEDIR
+PWLIBMAKEDIR=@makdir@
 endif
 
 ####################################################
 
 # include generated build options file, then include it
-include $(PWLIBDIR)/make/ptbuildopts.mak
+include $(PWLIBMAKEDIR)/ptbuildopts.mak
 
 ###############################################################################
 #
--- pwlib/make/ptbuildopts.mak.in.orig	2003-05-22 14:16:24.000000000 +0200
+++ pwlib/make/ptbuildopts.mak.in	2003-07-13 13:12:17.000000000 +0200
@@ -1,14 +1,15 @@
 # This file is automatically generated by autoconf
 #
 
-PWLIBDIR   = @PWLIBDIR@
+ifndef PWLIBDIR
+PWLIBDIR   = @INSTALLPREFIX@
+endif
 
 MACHTYPE   = @MACHTYPE@
 OSTYPE	   = @OSTYPE@
 OSRELEASE  = @OSRELEASE@
 
 STDCCFLAGS += @STDCCFLAGS@
-LDFLAGS	   += @LDFLAGS@
 ENDLDLIBS  += @ENDLDLIBS@
 
 HAS_OPENSSL	= @HAS_OPENSSL@
--- pwlib/make/ptlib-config.in.orig	2003-04-28 03:10:03.000000000 +0200
+++ pwlib/make/ptlib-config.in	2003-07-13 13:12:47.000000000 +0200
@@ -6,9 +6,9 @@
 
 VERSION="@PWLIB_VERSION@"
 CCFLAGS="@STDCCFLAGS@"
-LDFLAGS="@LDFLAGS@"
+LDFLAGS=""
 LIBS="@ENDLDLIBS@"
-PWLIBDIR="@PWLIBDIR@"
+PWLIBDIR="@INSTALLPREFIX@"
 MACHTYPE="@MACHTYPE@"
 OSTYPE="@OSTYPE@"
 OSRELEASE="@OSRELEASE@"
